<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HydroLens â€” Smart Water Monitoring</title>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <style>
    :root {
      --bg:      #07111a;
      --panel:   #0d1f2d;
      --panel2:  #112233;
      --border:  #1a3a52;
      --teal:    #00c9b1;
      --cyan:    #00e5ff;
      --yellow:  #f5c842;
      --warn:    #ff9f1c;
      --danger:  #ff3d57;
      --text:    #cce8f0;
      --muted:   #3a6a82;
      --white:   #ffffff;
      --head:    'Rajdhani', sans-serif;
      --body:    'Inter', sans-serif;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    html { scroll-behavior: smooth; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--body);
      min-height: 100vh;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       NAVBAR
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    nav {
      position: fixed;
      top: 0; left: 0; right: 0;
      z-index: 100;
      background: rgba(7,17,26,0.92);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 32px;
    }

    .nav-logo {
      font-family: var(--head);
      font-size: 1.6rem;
      font-weight: 700;
      color: var(--white);
      letter-spacing: 1px;
    }
    .nav-logo span { color: var(--teal); }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .nav-links a {
      color: var(--muted);
      text-decoration: none;
      font-size: 0.85rem;
      font-weight: 500;
      padding: 6px 14px;
      border-radius: 4px;
      transition: all 0.2s;
      letter-spacing: 0.5px;
    }
    .nav-links a:hover { color: var(--text); background: var(--panel); }

    .nav-btn {
      background: var(--teal) !important;
      color: var(--bg) !important;
      font-weight: 600 !important;
      border-radius: 4px !important;
    }
    .nav-btn:hover { opacity: 0.85; }

    /* Live dot in nav */
    .nav-live {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.72rem;
      color: var(--muted);
      letter-spacing: 1px;
      margin-right: 8px;
    }
    .nlive-dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: var(--danger);
      transition: background 0.4s;
    }
    .nlive-dot.on { background: var(--teal); box-shadow: 0 0 6px var(--teal); animation: nblink 2s infinite; }
    @keyframes nblink { 0%,100%{opacity:1} 50%{opacity:0.3} }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HERO / SENSOR SECTION
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .hero {
      padding-top: 100px;
      padding-bottom: 60px;
      text-align: center;
    }

    .hero-title {
      font-family: var(--head);
      font-size: 2.8rem;
      font-weight: 700;
      color: var(--white);
      letter-spacing: 2px;
      margin-bottom: 8px;
    }
    .hero-title span { color: var(--teal); }

    .hero-sub {
      font-size: 0.9rem;
      color: var(--muted);
      letter-spacing: 2px;
      text-transform: uppercase;
      margin-bottom: 48px;
    }

    /* Grid background */
    .hero::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        linear-gradient(rgba(0,201,177,0.025) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0,201,177,0.025) 1px, transparent 1px);
      background-size: 48px 48px;
      pointer-events: none;
      z-index: -1;
    }

    /* â”€â”€ Sensor Cards â”€â”€ */
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 20px;
      max-width: 900px;
      margin: 0 auto;
      padding: 0 24px;
    }

    .scard {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 28px 24px 22px;
      position: relative;
      overflow: hidden;
      animation: fadeUp 0.5s ease both;
    }
    .scard:nth-child(2) { animation-delay: 0.1s; }
    .scard:nth-child(3) { animation-delay: 0.2s; }

    @keyframes fadeUp {
      from { opacity:0; transform:translateY(18px); }
      to   { opacity:1; transform:translateY(0); }
    }

    .scard::before {
      content: '';
      position: absolute;
      left: 0; top: 0; bottom: 0;
      width: 3px;
    }
    .scard.turb::before { background: var(--teal); }
    .scard.tds::before  { background: var(--cyan); }
    .scard.volt::before { background: var(--yellow); }

    .scard::after {
      content: '';
      position: absolute;
      top: -30px; right: -30px;
      width: 100px; height: 100px;
      border-radius: 50%;
      filter: blur(40px);
      opacity: 0.06;
    }
    .scard.turb::after { background: var(--teal); }
    .scard.tds::after  { background: var(--cyan); }
    .scard.volt::after { background: var(--yellow); }

    .sc-label {
      font-family: var(--head);
      font-size: 0.68rem;
      font-weight: 600;
      letter-spacing: 3px;
      text-transform: uppercase;
      margin-bottom: 14px;
    }
    .scard.turb .sc-label { color: var(--teal); }
    .scard.tds  .sc-label { color: var(--cyan); }
    .scard.volt .sc-label { color: var(--yellow); }

    .sc-value {
      font-family: var(--head);
      font-size: 3.4rem;
      font-weight: 700;
      line-height: 1;
      color: var(--white);
      letter-spacing: -1px;
      transition: color 0.4s;
    }
    .sc-value.shimmer { color: var(--muted); animation: shim 1.5s infinite; }
    @keyframes shim { 0%,100%{opacity:0.3} 50%{opacity:1} }

    .sc-unit {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 4px;
      letter-spacing: 1px;
    }

    .sc-pill {
      display: inline-block;
      margin-top: 16px;
      padding: 4px 14px;
      border-radius: 2px;
      font-size: 0.68rem;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      transition: all 0.4s;
    }
    .p-excellent { background:#082e1a; color:#00ff9d; border:1px solid #00ff9d22; }
    .p-good      { background:#0b2e1a; color:#4ade80; border:1px solid #4ade8022; }
    .p-moderate  { background:#2e2000; color:#f5c842; border:1px solid #f5c84222; }
    .p-poor      { background:#2e1000; color:#ff9f1c; border:1px solid #ff9f1c22; }
    .p-danger    { background:#2e0008; color:#ff3d57; border:1px solid #ff3d5722; }
    .p-waiting   { background:#111e2a; color:var(--muted); border:1px solid var(--border); }

    .sc-ts {
      font-size: 0.68rem;
      color: var(--muted);
      margin-top: 10px;
    }

    /* â”€â”€ Combined bar â”€â”€ */
    .combined-bar {
      max-width: 900px;
      margin: 20px auto 0;
      padding: 0 24px;
    }

    .combined-inner {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 20px 28px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
      animation: fadeUp 0.5s 0.3s ease both;
    }

    .cb-label {
      font-family: var(--head);
      font-size: 0.65rem;
      font-weight: 600;
      letter-spacing: 3px;
      text-transform: uppercase;
      color: var(--muted);
      margin-bottom: 4px;
    }

    .cb-text {
      font-family: var(--head);
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--white);
    }

    .cb-pill {
      padding: 8px 22px;
      border-radius: 2px;
      font-family: var(--head);
      font-size: 0.8rem;
      font-weight: 700;
      letter-spacing: 2px;
      text-transform: uppercase;
      white-space: nowrap;
      transition: all 0.4s;
    }

    /* conn footer */
    .conn-footer {
      text-align: center;
      margin-top: 20px;
      font-size: 0.72rem;
      color: var(--muted);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      animation: fadeUp 0.5s 0.4s ease both;
    }
    .conn-dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: var(--danger);
      transition: background 0.4s;
    }
    .conn-dot.on { background: var(--teal); box-shadow: 0 0 6px var(--teal); animation: nblink 2s infinite; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAP SECTION
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .map-section {
      max-width: 900px;
      margin: 60px auto 0;
      padding: 0 24px 80px;
    }

    .section-title {
      font-family: var(--head);
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--white);
      letter-spacing: 2px;
      margin-bottom: 6px;
    }
    .section-sub {
      font-size: 0.78rem;
      color: var(--muted);
      letter-spacing: 1px;
      margin-bottom: 24px;
    }

    .map-wrap {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
      position: relative;
    }

    /* SVG dummy map */
    .map-svg-wrap {
      width: 100%;
      position: relative;
      background: #0a1e2c;
    }

    .map-svg-wrap svg {
      width: 100%;
      height: auto;
      display: block;
    }

    /* Map pins */
    .map-pin {
      cursor: pointer;
      transition: transform 0.2s;
    }
    .map-pin:hover { transform: scale(1.15); }

    /* Tooltip */
    .map-tooltip {
      position: absolute;
      background: var(--panel2);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 12px 16px;
      font-size: 0.78rem;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
      min-width: 180px;
      z-index: 10;
    }
    .map-tooltip.show { opacity: 1; }
    .tt-area { font-family: var(--head); font-size: 1rem; font-weight: 700; color: var(--white); margin-bottom: 6px; }
    .tt-row  { display: flex; justify-content: space-between; gap: 12px; margin-top: 4px; font-size: 0.72rem; color: var(--muted); }
    .tt-row span:last-child { color: var(--text); font-weight: 600; }

    /* Map legend */
    .map-legend {
      display: flex;
      gap: 20px;
      padding: 14px 20px;
      border-top: 1px solid var(--border);
      flex-wrap: wrap;
    }
    .leg-item {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.72rem;
      color: var(--muted);
    }
    .leg-dot {
      width: 10px; height: 10px;
      border-radius: 50%;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LOGIN MODAL OVERLAY
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(6px);
      z-index: 200;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
    }
    .overlay.show {
      opacity: 1;
      pointer-events: all;
    }

    .login-box {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 40px 36px;
      width: 100%;
      max-width: 380px;
      position: relative;
      animation: loginPop 0.3s ease;
    }
    @keyframes loginPop {
      from { transform: scale(0.93); opacity: 0; }
      to   { transform: scale(1);    opacity: 1; }
    }

    .login-close {
      position: absolute;
      top: 16px; right: 18px;
      background: none;
      border: none;
      color: var(--muted);
      font-size: 1.2rem;
      cursor: pointer;
      transition: color 0.2s;
    }
    .login-close:hover { color: var(--white); }

    .login-logo {
      font-family: var(--head);
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--white);
      margin-bottom: 4px;
    }
    .login-logo span { color: var(--teal); }

    .login-tagline {
      font-size: 0.75rem;
      color: var(--muted);
      margin-bottom: 28px;
      letter-spacing: 1px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      font-size: 0.72rem;
      color: var(--muted);
      letter-spacing: 1.5px;
      text-transform: uppercase;
      margin-bottom: 6px;
    }

    .form-group input {
      width: 100%;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 10px 14px;
      color: var(--white);
      font-family: var(--body);
      font-size: 0.9rem;
      outline: none;
      transition: border-color 0.2s;
    }
    .form-group input:focus { border-color: var(--teal); }
    .form-group input::placeholder { color: var(--muted); }

    .login-btn {
      width: 100%;
      background: var(--teal);
      color: var(--bg);
      border: none;
      border-radius: 4px;
      padding: 12px;
      font-family: var(--head);
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 2px;
      cursor: pointer;
      margin-top: 8px;
      transition: opacity 0.2s;
    }
    .login-btn:hover { opacity: 0.85; }

    .login-msg {
      text-align: center;
      font-size: 0.78rem;
      margin-top: 14px;
      color: var(--muted);
    }
    .login-msg a { color: var(--teal); text-decoration: none; }

    .login-error {
      background: #2e0008;
      border: 1px solid #ff3d5744;
      color: #ff3d57;
      border-radius: 4px;
      padding: 8px 12px;
      font-size: 0.78rem;
      margin-bottom: 14px;
      display: none;
    }

    .login-success {
      text-align: center;
      padding: 20px 0;
    }
    .ls-icon { font-size: 3rem; margin-bottom: 12px; }
    .ls-text { font-family: var(--head); font-size: 1.2rem; color: var(--teal); font-weight: 700; }
    .ls-sub  { font-size: 0.78rem; color: var(--muted); margin-top: 6px; }
  </style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     NAVBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav>
  <div class="nav-logo">Aqua<span>Lens</span></div>
  <div class="nav-links">
    <div class="nav-live">
      <div class="nlive-dot" id="nav-live-dot"></div>
      <span id="nav-live-text">Connecting</span>
    </div>
    <a href="#sensors">Dashboard</a>
    <a href="#map">Map</a>
    <a href="#" onclick="openLogin(); return false;" class="nav-btn">Login</a>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HERO + SENSOR CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section class="hero" id="sensors">
  <div class="hero-title">Aqua<span>Lens</span></div>
  <div class="hero-sub">Real-Time In-Pipe Water Quality Monitor â€” Nashik</div>

  <div class="cards-grid">

    <!-- Turbidity Card -->
    <div class="scard turb">
      <div class="sc-label">Turbidity</div>
      <div class="sc-value shimmer" id="ntu-val">--</div>
      <div class="sc-unit">NTU â€” Nephelometric Turbidity Units</div>
      <div class="sc-pill p-waiting" id="ntu-pill">Waiting...</div>
      <div class="sc-ts" id="ntu-ts">Last update: --</div>
    </div>

    <!-- TDS Card -->
    <div class="scard tds">
      <div class="sc-label">TDS</div>
      <div class="sc-value shimmer" id="tds-val">--</div>
      <div class="sc-unit">ppm â€” Parts Per Million</div>
      <div class="sc-pill p-waiting" id="tds-pill">Waiting...</div>
      <div class="sc-ts" id="tds-ts">Last update: --</div>
    </div>

    <!-- Voltage Card -->
    <div class="scard volt">
      <div class="sc-label">Sensor Voltage</div>
      <div class="sc-value shimmer" id="volt-val">--</div>
      <div class="sc-unit">V â€” Turbidity Sensor Output</div>
      <div class="sc-ts" style="margin-top:36px;" id="volt-ts">Last update: --</div>
    </div>

  </div>

  <!-- Combined bar -->
  <div class="combined-bar">
    <div class="combined-inner">
      <div>
        <div class="cb-label">Overall Water Quality</div>
        <div class="cb-text" id="cb-text">Waiting for sensor data...</div>
      </div>
      <div class="cb-pill p-waiting" id="cb-pill">--</div>
    </div>
  </div>

  <!-- Connection -->
  <div class="conn-footer">
    <div class="conn-dot" id="conn-dot"></div>
    <span id="conn-text">Connecting to Firebase...</span>
  </div>
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAP SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<section class="map-section" id="map">
  <div class="section-title">Water Quality Map</div>
  <div class="section-sub">NASHIK CITY â€” CLICK A ZONE TO VIEW DETAILS</div>

  <div class="map-wrap">
    <div class="map-svg-wrap" id="map-container">

      <!-- Dummy SVG road map of Nashik areas -->
      <svg viewBox="0 0 800 480" xmlns="http://www.w3.org/2000/svg">
        <!-- Background -->
        <rect width="800" height="480" fill="#0a1e2c"/>

        <!-- River (Godavari) -->
        <path d="M0,200 Q100,180 200,210 Q320,240 420,220 Q540,200 650,230 Q730,250 800,240"
              fill="none" stroke="#1a4a6a" stroke-width="18" opacity="0.7"/>
        <path d="M0,200 Q100,180 200,210 Q320,240 420,220 Q540,200 650,230 Q730,250 800,240"
              fill="none" stroke="#1e5f82" stroke-width="10" opacity="0.5"/>
        <text x="320" y="248" fill="#2a7a9a" font-size="11" font-family="Inter" opacity="0.8">Godavari River</text>

        <!-- Major roads -->
        <line x1="0" y1="300" x2="800" y2="300" stroke="#1a3a52" stroke-width="8"/>
        <line x1="400" y1="0" x2="400" y2="480" stroke="#1a3a52" stroke-width="8"/>
        <line x1="0" y1="150" x2="800" y2="150" stroke="#162d3f" stroke-width="4"/>
        <line x1="200" y1="0" x2="200" y2="480" stroke="#162d3f" stroke-width="4"/>
        <line x1="600" y1="0" x2="600" y2="480" stroke="#162d3f" stroke-width="4"/>
        <line x1="0" y1="380" x2="800" y2="380" stroke="#162d3f" stroke-width="3"/>

        <!-- Diagonal roads -->
        <line x1="0" y1="480" x2="400" y2="150" stroke="#11283a" stroke-width="3"/>
        <line x1="800" y1="480" x2="400" y2="150" stroke="#11283a" stroke-width="3"/>
        <line x1="200" y1="0"  x2="600" y2="480" stroke="#11283a" stroke-width="2"/>

        <!-- Area blocks (subtle) -->
        <rect x="10"  y="310" width="180" height="60" rx="4" fill="#0d2030" opacity="0.5"/>
        <rect x="210" y="310" width="180" height="60" rx="4" fill="#0d2030" opacity="0.5"/>
        <rect x="410" y="310" width="180" height="60" rx="4" fill="#0d2030" opacity="0.5"/>
        <rect x="610" y="310" width="180" height="60" rx="4" fill="#0d2030" opacity="0.5"/>
        <rect x="10"  y="160" width="180" height="60" rx="4" fill="#0d2030" opacity="0.4"/>
        <rect x="410" y="160" width="180" height="60" rx="4" fill="#0d2030" opacity="0.4"/>
        <rect x="610" y="160" width="180" height="60" rx="4" fill="#0d2030" opacity="0.4"/>
        <rect x="10"  y="390" width="180" height="80" rx="4" fill="#0d2030" opacity="0.3"/>
        <rect x="610" y="390" width="180" height="80" rx="4" fill="#0d2030" opacity="0.3"/>

        <!-- Area name labels -->
        <text x="100"  y="345" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">PANCHAVATI</text>
        <text x="300"  y="345" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">UPNAGAR NAKA</text>
        <text x="500"  y="345" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">AMRUTNAGAR</text>
        <text x="700"  y="345" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">SATPUR</text>
        <text x="100"  y="195" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">NASHIK ROAD</text>
        <text x="500"  y="195" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">CBS CHOWK</text>
        <text x="700"  y="195" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">DWARKA</text>
        <text x="100"  y="435" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">GANGAPUR</text>
        <text x="700"  y="435" fill="#2a5a72" font-size="9" font-family="Inter" text-anchor="middle">CIDCO</text>

        <!-- NASHIK label center -->
        <text x="400" y="100" fill="#1a5a7a" font-size="28" font-family="Rajdhani" font-weight="700"
              text-anchor="middle" opacity="0.25" letter-spacing="6">NASHIK</text>

      </svg>

      <!-- MAP PINS (absolute positioned over SVG) -->
      <!-- Panchavati - CAUTION -->
      <div class="map-pin" style="position:absolute;left:11%;top:62%;"
           onclick="showTooltip(event,'Panchavati','âš ï¸ CAUTION','TDS: 480 ppm','NTU: 6.2','warn')">
        <svg width="28" height="36" viewBox="0 0 28 36">
          <path d="M14 0C6.27 0 0 6.27 0 14c0 9.33 14 22 14 22S28 23.33 28 14C28 6.27 21.73 0 14 0z" fill="#ff9f1c"/>
          <circle cx="14" cy="14" r="6" fill="#07111a"/>
        </svg>
      </div>

      <!-- Upnagar Naka - SAFE -->
      <div class="map-pin" style="position:absolute;left:35%;top:62%;"
           onclick="showTooltip(event,'Upnagar Naka','âœ… SAFE','TDS: 220 ppm','NTU: 1.8','safe')">
        <svg width="28" height="36" viewBox="0 0 28 36">
          <path d="M14 0C6.27 0 0 6.27 0 14c0 9.33 14 22 14 22S28 23.33 28 14C28 6.27 21.73 0 14 0z" fill="#00c9b1"/>
          <circle cx="14" cy="14" r="6" fill="#07111a"/>
        </svg>
      </div>

      <!-- Amrutnagar - UNSAFE -->
      <div class="map-pin" style="position:absolute;left:60%;top:62%;"
           onclick="showTooltip(event,'Amrutnagar','âŒ UNSAFE','TDS: 1240 ppm','NTU: 18.5','danger')">
        <svg width="28" height="36" viewBox="0 0 28 36">
          <path d="M14 0C6.27 0 0 6.27 0 14c0 9.33 14 22 14 22S28 23.33 28 14C28 6.27 21.73 0 14 0z" fill="#ff3d57"/>
          <circle cx="14" cy="14" r="6" fill="#07111a"/>
        </svg>
      </div>

      <!-- Satpur - SAFE -->
      <div class="map-pin" style="position:absolute;left:84%;top:62%;"
           onclick="showTooltip(event,'Satpur','âœ… SAFE','TDS: 310 ppm','NTU: 2.1','safe')">
        <svg width="28" height="36" viewBox="0 0 28 36">
          <path d="M14 0C6.27 0 0 6.27 0 14c0 9.33 14 22 14 22S28 23.33 28 14C28 6.27 21.73 0 14 0z" fill="#00c9b1"/>
          <circle cx="14" cy="14" r="6" fill="#07111a"/>
        </svg>
      </div>

      <!-- CBS Chowk - SAFE -->
      <div class="map-pin" style="position:absolute;left:57%;top:36%;"
           onclick="showTooltip(event,'CBS Chowk','âœ… SAFE','TDS: 180 ppm','NTU: 1.2','safe')">
        <svg width="28" height="36" viewBox="0 0 28 36">
          <path d="M14 0C6.27 0 0 6.27 0 14c0 9.33 14 22 14 22S28 23.33 28 14C28 6.27 21.73 0 14 0z" fill="#00c9b1"/>
          <circle cx="14" cy="14" r="6" fill="#07111a"/>
        </svg>
      </div>

      <!-- Gangapur - CAUTION -->
      <div class="map-pin" style="position:absolute;left:11%;top:83%;"
           onclick="showTooltip(event,'Gangapur','âš ï¸ CAUTION','TDS: 520 ppm','NTU: 7.8','warn')">
        <svg width="28" height="36" viewBox="0 0 28 36">
          <path d="M14 0C6.27 0 0 6.27 0 14c0 9.33 14 22 14 22S28 23.33 28 14C28 6.27 21.73 0 14 0z" fill="#ff9f1c"/>
          <circle cx="14" cy="14" r="6" fill="#07111a"/>
        </svg>
      </div>

      <!-- Tooltip -->
      <div class="map-tooltip" id="map-tooltip">
        <div class="tt-area" id="tt-area">--</div>
        <div class="tt-row"><span>Status</span><span id="tt-status">--</span></div>
        <div class="tt-row"><span>TDS</span><span id="tt-tds">--</span></div>
        <div class="tt-row"><span>Turbidity</span><span id="tt-ntu">--</span></div>
      </div>

    </div><!-- map-svg-wrap -->

    <!-- Legend -->
    <div class="map-legend">
      <div class="leg-item"><div class="leg-dot" style="background:#00c9b1"></div> Safe</div>
      <div class="leg-item"><div class="leg-dot" style="background:#ff9f1c"></div> Caution</div>
      <div class="leg-item"><div class="leg-dot" style="background:#ff3d57"></div> Unsafe</div>
      <div style="margin-left:auto;font-size:0.7rem;color:var(--muted);">â˜… Dummy data for demo purposes</div>
    </div>
  </div><!-- map-wrap -->
</section>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     LOGIN MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="overlay" id="login-overlay" onclick="overlayClick(event)">
  <div class="login-box" id="login-box">
    <button class="login-close" onclick="closeLogin()">âœ•</button>

    <!-- Form view -->
    <div id="login-form-view">
      <div class="login-logo">Aqua<span>Lens</span></div>
      <div class="login-tagline">Sign in to access your dashboard</div>

      <div class="login-error" id="login-error">Invalid email or password. Try again.</div>

      <div class="form-group">
        <label>Email Address</label>
        <input type="email" id="login-email" placeholder="you@example.com" autocomplete="email"/>
      </div>

      <div class="form-group">
        <label>Password</label>
        <input type="password" id="login-pass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password"
               onkeydown="if(event.key==='Enter') doLogin()"/>
      </div>

      <button class="login-btn" onclick="doLogin()">SIGN IN</button>

      <div class="login-msg">
        Don't have an account? <a href="#" onclick="alert('Registration coming soon!'); return false;">Register</a>
      </div>
    </div>

    <!-- Success view -->
    <div id="login-success-view" class="login-success" style="display:none;">
      <div class="ls-icon">ğŸ’§</div>
      <div class="ls-text">Welcome Back!</div>
      <div class="ls-sub" id="ls-email-text">Logged in successfully</div>
    </div>

  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SCRIPTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script type="module">
  import { initializeApp }             from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

  const firebaseConfig = {
    apiKey:            "AIzaSyBab-qChNIv1QNfbMmS1xaAI1JYUl2YZQE",
    authDomain:        "iot-basics-5ba4b.firebaseapp.com",
    databaseURL:       "https://iot-basics-5ba4b-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId:         "iot-basics-5ba4b",
    storageBucket:     "iot-basics-5ba4b.firebasestorage.app",
    messagingSenderId: "415035899767",
    appId:             "1:415035899767:web:ccbf7b34f4b486809fab72"
  };

  const app = initializeApp(firebaseConfig);
  const db  = getDatabase(app);

  function ntuInfo(v) {
    if (v < 5)   return { label:"Clean",           cls:"p-excellent" };
    if (v < 50)  return { label:"Slightly Turbid", cls:"p-moderate"  };
    if (v < 500) return { label:"Turbid",           cls:"p-poor"      };
    return              { label:"Very Dirty",       cls:"p-danger"    };
  }

  function tdsInfo(v) {
    if (v < 300)  return { label:"Excellent",  cls:"p-excellent" };
    if (v < 500)  return { label:"Good",        cls:"p-good"      };
    if (v < 1000) return { label:"Acceptable",  cls:"p-moderate"  };
    if (v < 2000) return { label:"Poor",        cls:"p-poor"      };
    return               { label:"Dangerous",   cls:"p-danger"    };
  }

  function combined(tds, ntu) {
    const tOK = tds < 500, nOK = ntu < 5;
    if (tOK && nOK)   return { text:"Water is Clean â€” Safe to Drink",          cls:"p-excellent", badge:"âœ“ CLEAN"   };
    if (!tOK && !nOK) return { text:"Water is Contaminated â€” Do Not Drink",    cls:"p-danger",    badge:"âœ— UNSAFE"  };
    if (!tOK)         return { text:"High Dissolved Solids â€” Filter Advised",  cls:"p-moderate",  badge:"âš  CAUTION" };
    return                   { text:"High Turbidity â€” Particles Detected",     cls:"p-poor",      badge:"âš  CAUTION" };
  }

  function setPill(id, label, cls) {
    const el = document.getElementById(id);
    el.textContent = label;
    el.className = "sc-pill " + cls;
  }

  function ts() { return "Last update: " + new Date().toLocaleTimeString(); }

  function setConnected() {
    document.getElementById("conn-dot").classList.add("on");
    document.getElementById("conn-text").textContent = "Live â€” updating every 5s";
    document.getElementById("nav-live-dot").classList.add("on");
    document.getElementById("nav-live-text").textContent = "Live";
  }

  let latestTDS = null, latestNTU = null;

  function updateCombined() {
    if (latestTDS === null || latestNTU === null) return;
    const info = combined(latestTDS, latestNTU);
    document.getElementById("cb-text").textContent = info.text;
    const cp = document.getElementById("cb-pill");
    cp.textContent = info.badge;
    cp.className   = "cb-pill " + info.cls;
  }

  // Listen: /turbidity
  onValue(ref(db, "/turbidity"), (snap) => {
    const d = snap.val();
    if (!d) return;

    const ntu  = parseFloat(d.ntu     ?? 0);
    const volt = parseFloat(d.voltage ?? 0);
    latestNTU  = ntu;

    const nEl = document.getElementById("ntu-val");
    nEl.textContent = ntu.toFixed(1);
    nEl.classList.remove("shimmer");

    const vEl = document.getElementById("volt-val");
    vEl.textContent = volt.toFixed(3);
    vEl.classList.remove("shimmer");

    const now = ts();
    document.getElementById("ntu-ts").textContent  = now;
    document.getElementById("volt-ts").textContent = now;

    const info = ntuInfo(ntu);
    setPill("ntu-pill", info.label, info.cls);

    updateCombined();
    setConnected();
  });

  // Listen: /tds
  onValue(ref(db, "/tds"), (snap) => {
    const d = snap.val();
    if (!d) return;

    const tds = parseFloat(d.tds ?? d.value ?? d.ppm ?? 0);
    latestTDS  = tds;

    const el = document.getElementById("tds-val");
    el.textContent = tds.toFixed(1);
    el.classList.remove("shimmer");

    document.getElementById("tds-ts").textContent = ts();

    const info = tdsInfo(tds);
    setPill("tds-pill", info.label, info.cls);

    updateCombined();
    setConnected();
  });
</script>

<script>
  // â”€â”€ Map tooltip â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  let tooltipVisible = false;

  function showTooltip(e, area, status, tds, ntu, type) {
    const tt  = document.getElementById("map-tooltip");
    const con = document.getElementById("map-container");
    const rect = con.getBoundingClientRect();

    document.getElementById("tt-area").textContent   = area;
    document.getElementById("tt-status").textContent = status;
    document.getElementById("tt-tds").textContent    = tds;
    document.getElementById("tt-ntu").textContent    = ntu;

    // Color status text
    const statusColors = { safe:"#00c9b1", warn:"#ff9f1c", danger:"#ff3d57" };
    document.getElementById("tt-status").style.color = statusColors[type] || "#fff";

    // Position tooltip near click
    let left = e.clientX - rect.left + 16;
    let top  = e.clientY - rect.top  - 20;
    if (left + 200 > con.offsetWidth) left -= 220;
    if (top  + 140 > con.offsetHeight) top  -= 120;

    tt.style.left = left + "px";
    tt.style.top  = top  + "px";
    tt.classList.add("show");
    tooltipVisible = true;

    e.stopPropagation();
  }

  // Hide tooltip on click elsewhere
  document.addEventListener("click", () => {
    if (tooltipVisible) {
      document.getElementById("map-tooltip").classList.remove("show");
      tooltipVisible = false;
    }
  });

  // â”€â”€ Login Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function openLogin() {
    document.getElementById("login-overlay").classList.add("show");
    document.getElementById("login-form-view").style.display  = "block";
    document.getElementById("login-success-view").style.display = "none";
    document.getElementById("login-error").style.display = "none";
  }

  function closeLogin() {
    document.getElementById("login-overlay").classList.remove("show");
  }

  function overlayClick(e) {
    if (e.target === document.getElementById("login-overlay")) closeLogin();
  }

  function doLogin() {
    const email = document.getElementById("login-email").value.trim();
    const pass  = document.getElementById("login-pass").value;

    // Demo credentials check
    const valid =
      (email === "testing2@gmail.com" && pass === "testing123") ||
      (email === "admin@jalmonitor.in"  && pass === "jal2024")   ||
      (email.length > 4 && pass.length >= 6); // accept any valid-looking login for demo

    if (!email || !pass) {
      document.getElementById("login-error").textContent = "Please enter email and password.";
      document.getElementById("login-error").style.display = "block";
      return;
    }

    if (valid) {
      document.getElementById("login-form-view").style.display    = "none";
      document.getElementById("login-success-view").style.display = "block";
      document.getElementById("ls-email-text").textContent = "Welcome, " + email;
      setTimeout(closeLogin, 2200);
    } else {
      document.getElementById("login-error").textContent = "Invalid credentials. Try again.";
      document.getElementById("login-error").style.display = "block";
    }
  }

  // Make functions global
  window.openLogin   = openLogin;
  window.closeLogin  = closeLogin;
  window.overlayClick = overlayClick;
  window.doLogin     = doLogin;
  window.showTooltip = showTooltip;
</script>
</body>
</html>
